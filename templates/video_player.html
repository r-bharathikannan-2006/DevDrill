<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Quiz</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
        }
        .quiz-question {
            display: none;
        }
        .quiz-question.active {
            display: block;
        }
        .justify_td{
            align-items: center;
        }

        .border_black{
            border: solid black 2px;
        }
        .summary_container{
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 50px;
            width: 1150px;
        }
        .summary{
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .summary_topic{
            font-weight: 500;
        }
        .para{
            margin-top: 30px;
        }
        
        
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col items-center justify-center p-4">

    <div class="border_black w-full max-w-6xl bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col justify_td lg:flex-row">
        
        <!-- Video Section (Left Half) -->
        <div class="w-full lg:w-1/2 p-4">
            <div class="relative w-full aspect-video rounded-xl overflow-hidden">
                <!-- Replace 'YOUTUBE_VIDEO_ID' with the ID of your desired YouTube video -->
                <iframe 
                    class="absolute top-0 left-0 w-full h-full" 
                    src="https://www.youtube.com/embed/{{video_id}}" 
                    frameborder="0" 
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                    allowfullscreen>
                </iframe>
            </div>
        </div>

        <!-- Quiz Section (Right Half) -->
        <div class="w-full lg:w-1/2 p-6 flex flex-col justify-center">
            <div id="quiz-container" class="space-y-6">
                {% for question_obj in questions %}
                <!-- Question 1 -->
                <div id="question-{{ forloop.counter0 }}" class="quiz-question {% if forloop.first %}active{% endif %}">
                    <div class="bg-blue-50 p-6 rounded-lg shadow-inner">
                        <h2 class="text-xl font-bold text-gray-800 mb-4">{{ question_obj.question }}</h2>
                        <div class="space-y-4">
                            <button class="w-full text-left p-4 bg-gray-100 hover:bg-gray-200 transition-colors duration-200 rounded-lg shadow-sm border border-gray-200 font-medium text-gray-700" onclick="checkAnswer(this, {{ forloop.counter0 }}, '{{ question_obj.optionA }}')">{{ question_obj.optionA }}</button>
                            <button class="w-full text-left p-4 bg-gray-100 hover:bg-gray-200 transition-colors duration-200 rounded-lg shadow-sm border border-gray-200 font-medium text-gray-700" onclick="checkAnswer(this, {{ forloop.counter0 }}, '{{ question_obj.optionB }}')">{{ question_obj.optionB }}</button>
                            <button class="w-full text-left p-4 bg-gray-100 hover:bg-gray-200 transition-colors duration-200 rounded-lg shadow-sm border border-gray-200 font-medium text-gray-700" onclick="checkAnswer(this, {{ forloop.counter0 }}, '{{ question_obj.optionC }}')">{{ question_obj.optionC }}</button>
                            <button class="w-full text-left p-4 bg-gray-100 hover:bg-gray-200 transition-colors duration-200 rounded-lg shadow-sm border border-gray-200 font-medium text-gray-700" onclick="checkAnswer(this, {{ forloop.counter0 }}, '{{ question_obj.optionD }}')">{{ question_obj.optionD }}</button>
                        </div>
                    </div>
                    <div class="flex justify-end mt-4">
                        <button id="next-btn-{{ forloop.counter0 }}" class="px-6 py-2 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 transition-colors duration-200" style="display: none;" onclick="nextQuestion()">Next</button>
                    </div>
                </div>
                {% endfor %}
                
                <!-- Results Screen -->
                <div id="results-screen" class="quiz-question">
                    <div class="bg-gray-50 p-8 rounded-lg shadow-inner text-center space-y-4">
                        <h2 class="text-3xl font-bold text-gray-800">Quiz Complete!</h2>
                        <p class="text-5xl font-extrabold text-blue-600" id="percentage-score">0%</p>
                        <p class="text-2xl font-semibold text-gray-700">You scored <span class="text-blue-600" id="current-score">0</span> out of <span class="text-blue-600">10</span> questions.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="border_black summary_container p-4 bg-white rounded-xl shadow-2xl ">
        <div class="summary">
            <h3 class="summary_topic"><b>Summary</b></h3>
        </div>
        <div class="'para_container">
            <p class="para">{{ summary }}</p>
        </div>
    </div>

    <script>
    let currentQuestionIndex = 0;
    let score = 0;
    
    // Total questions should be the length of the quizData array
    const quizData = [
        {% for question_obj in questions %}
        { answer: "{{ question_obj.correct }}" }{% if not forloop.last %},{% endif %}
        {% endfor %}
    ];
    const totalQuestions = quizData.length;

    function checkAnswer(button, questionIndex, selectedOption) {
        const currentQuestion = quizData[questionIndex];
        const optionsContainer = button.parentNode;
        const options = optionsContainer.querySelectorAll('button');
        
        // Find the correct next button using its dynamic ID
        const nextButton = document.getElementById('next-btn-' + questionIndex);
        
        // Disable all option buttons for the current question
        options.forEach(option => {
            option.disabled = true;
            if (option.textContent.trim() === currentQuestion.answer) {
                // Highlight the correct answer in green
                option.classList.add('bg-green-500', 'text-white', 'hover:bg-green-500');
                option.classList.remove('bg-gray-100', 'hover:bg-gray-200', 'text-gray-700');
            } else if (option.textContent.trim() === selectedOption) {
                // Highlight the incorrect selected answer in red
                option.classList.add('bg-red-500', 'text-white', 'hover:bg-red-500');
                option.classList.remove('bg-gray-100', 'hover:bg-gray-200', 'text-gray-700');
            }
        });
        
        // Increment score if the selected option is correct
        if (selectedOption === currentQuestion.answer) {
            score++;
        }
        
        // Show the next button
        if (nextButton) {
            nextButton.style.display = 'block';
        }
    }

    function nextQuestion() {
        const currentQuestionElement = document.getElementById('question-' + currentQuestionIndex);
        currentQuestionElement.classList.remove('active');
        
        currentQuestionIndex++;

        if (currentQuestionIndex < totalQuestions) {
            const nextQuestionElement = document.getElementById('question-' + currentQuestionIndex);
            if (nextQuestionElement) {
                nextQuestionElement.classList.add('active');
            }
        } else {
            showResults();
        }
    }

    function showResults() {
        const percentage = (score / totalQuestions) * 100;
        document.getElementById('current-score').textContent = score;
        document.getElementById('percentage-score').textContent = percentage.toFixed(0) + '%';
        
        const resultsScreen = document.getElementById('results-screen');
        if (resultsScreen) {
            resultsScreen.classList.add('active');
        }
    }
</script>
</body>
</html>
